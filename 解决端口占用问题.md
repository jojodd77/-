# 🔧 解决端口 3001 占用问题

## 问题描述

启动开发服务器时出现错误：
```
Error: listen EADDRINUSE: address already in use :::3001
```

这表示端口 3001 已被其他进程占用。

## ✅ 解决方案

### 方法 1：使用自动脚本（推荐）

```bash
cd /Users/jojodd/my-tool-platform
bash 强制停止端口3001.sh
```

### 方法 2：手动停止进程

#### 步骤 1：查找占用端口的进程

```bash
lsof -i :3001
```

或者

```bash
lsof -ti :3001
```

#### 步骤 2：停止进程

```bash
# 方法 A: 使用进程 ID
kill -9 <PID>

# 方法 B: 直接停止
lsof -ti :3001 | xargs kill -9

# 方法 C: 停止所有 Next.js 进程
pkill -f "next dev"

# 方法 D: 停止所有 node 进程（谨慎使用）
killall -9 node
```

#### 步骤 3：验证端口已释放

```bash
lsof -i :3001
```

如果没有输出，说明端口已释放。

#### 步骤 4：重新启动开发服务器

```bash
cd /Users/jojodd/my-tool-platform
npm run dev
```

### 方法 3：使用其他端口（临时方案）

如果无法停止占用端口的进程，可以使用其他端口：

```bash
cd /Users/jojodd/my-tool-platform
npm run dev -- -p 3002
```

然后访问 http://localhost:3002

## 🔍 详细排查步骤

### 1. 查看所有占用端口的进程

```bash
lsof -i :3001
```

输出示例：
```
COMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
node    12345 jojodd   17u  IPv6  ...      0t0  TCP *:3001 (LISTEN)
```

### 2. 查看进程详细信息

```bash
ps aux | grep <PID>
```

### 3. 强制停止进程

```bash
kill -9 <PID>
```

### 4. 如果进程无法停止

可能需要使用管理员权限：

```bash
sudo lsof -ti :3001 | xargs sudo kill -9
```

## 🐛 常见问题

### Q: 为什么进程无法停止？

A: 可能的原因：
1. 进程正在执行重要操作
2. 进程被系统保护
3. 需要管理员权限

解决方法：
- 等待几秒后重试
- 使用 `sudo` 权限
- 重启终端或电脑

### Q: 停止进程后立即重启仍然报错？

A: 可能的原因：
1. 进程还在清理中（需要等待几秒）
2. 有多个进程占用同一端口

解决方法：
```bash
# 等待 3-5 秒
sleep 5

# 再次检查
lsof -i :3001

# 如果仍然占用，使用更强制的方法
pkill -9 -f "next dev"
killall -9 node
```

### Q: 如何避免这个问题？

A: 建议：
1. **启动前先检查端口**
   ```bash
   lsof -i :3001
   ```

2. **使用脚本自动处理**
   ```bash
   # 在启动前先停止旧进程
   lsof -ti :3001 | xargs kill -9 2>/dev/null
   npm run dev
   ```

3. **使用不同的端口**
   - 修改 `package.json` 中的端口号
   - 或使用环境变量

## 📝 快速命令

一键停止并重启：

```bash
cd /Users/jojodd/my-tool-platform
lsof -ti :3001 | xargs kill -9 2>/dev/null
sleep 2
npm run dev
```

## ✅ 验证修复

停止进程后，运行：

```bash
npm run dev
```

应该看到：
```
▲ Next.js 14.2.5
- Local:        http://localhost:3001
- Ready in X.Xs
```

如果仍然报错，请：
1. 等待 5-10 秒后重试
2. 检查是否有其他终端窗口也在运行 `npm run dev`
3. 重启终端或电脑



