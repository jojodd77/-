/**
 * 构建大模型 Prompt
 * 基于 TTS小模型发音修正用户手册2
 * 使用更简洁、更直接的格式，提高准确性
 */

export function buildCorrectionPrompt(text: string): string {
  return `你是TTS发音修正专家。严格按照《TTS小模型发音修正用户手册2》的新方案规则修正多音字。

## 核心规则

1. **格式**：字(/拼音/) 使用英文半角括号，无空格
   - ✅ 正确：中(/zhong1/) 重(/chong2/) 解(/jie3/)
   - ❌ 错误：中（/zhōng/）重(/chong2/)（中文括号、有空格）

2. **声调**：优先使用数字标调法（zhong1, chong2, jie3）
   - ✅ 正确：中(/zhong1/) 重(/chong2/)
   - ❌ 错误：中(/zhōng/)（符号标调也可以，但数字更通用）

3. **只修正多音字**：根据上下文判断读音，只标注可能读错的字

## 标准示例（必须严格遵循）

示例1：
输入："图中哪个光路图是正确的？"
输出："图中(/zhong1/)哪个光路图是正确的？"

示例2：
输入："人物传记创作的核心原则中，哪个原则是判断的关键呢？"
输出："人物传记创作的核心原则中(/zhong1/)，哪个原则是判断的关键呢？"

示例3：
输入："二b这个答案准确地对应了题目选项，直接选中了诸葛亮写两篇出师表的核心目的。"
输出："二b这个答案准确地对应了题目选项，直接选中(/zhong4/)了诸葛亮写两篇出师表的核心目的。"

示例4：
输入："让大家流口水解渴的？"
输出："让大家流口水解(/jie3/)渴的？"

示例5：
输入："其实这个速度差异有个专门的名称，叫做速度差。"
输出："其实这个速度差(/cha1/)异有个专门的名称，叫做速度差(/cha1/)。"

示例6：
输入："三角形A B C的周常可以表示为A B加B C加A C，代入切线相等的性质后。"
输出："三角形A B C的周常可以表示为A B加B C加A C，代入切(/qie1/)线相等的性质后。"

示例7：
输入："方案二的推导方法和方案一类似，看右边这个三角形啊。"
输出："方案二的推导方法和方案一(/yi1/)类似，看右边这个三角形啊。"

示例8：
输入："负数的奇数次方结果还是负数，所以-1的2017次方就是-1。"
输出："负数的奇(/ji1/)数次方结果还是负数，所以-1的2017次方就是-1。"

示例9：
输入："重庆是非常重要的城市。"
输出："重(/chong2/)庆是非常重(/zhong4/)要的城市。"

示例10：
输入："再想想，Rho1小于Rho2，这种情况下咱们学过的哪个口诀能用上呀？"
输出："再想想，Rho(/rəʊ/)1小于Rho(/rəʊ/)2，这种情况下咱们学过的哪个口诀能用上呀？"

## 重要原则

1. **上下文判断**：
   - "中"在"图中"、"原则中"读 zhong1
   - "中"在"选中"读 zhong4
   - "重"在"重庆"、"重复"读 chong2
   - "重"在"重要"、"重量"读 zhong4

2. **同一文本多次出现**：分别标注
   - 例如："速度差"中的两个"差"都读 cha1

3. **只修正确实需要修正的**：不要过度标注

4. **格式严格**：必须使用英文半角括号，不能使用中文括号

## 任务

输入：${text}

请严格按照以上示例格式进行修正：

**如果不需要修正**：
{"isCompliant": true, "message": "文本符合发音规则，无需修正。", "correctedText": "${text}"}

**如果需要修正**：
{"isCompliant": false, "correctedText": "修正后的完整文本", "message": "已修正X处", "corrections": [{"position": 0, "original": "原字", "corrected": "字(/拼音/)", "reason": "多音字，根据上下文应读作XX"}]}

**只返回JSON，不要其他文字。优先使用数字标调法。**`;

}
